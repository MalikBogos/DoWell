<Window x:Class="DoWell.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Excel Clone - Werkblad" Height="600" Width="1000"
        WindowState="Maximized">

    <Window.Resources>
        <!-- Styles voor DataGrid -->
        <Style x:Key="ExcelDataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="GridLinesVisibility" Value="All"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#E0E0E0"/>
            <Setter Property="VerticalGridLinesBrush" Value="#E0E0E0"/>
            <Setter Property="HeadersVisibility" Value="All"/>
            <Setter Property="CanUserAddRows" Value="True"/>
            <Setter Property="CanUserDeleteRows" Value="True"/>
            <Setter Property="CanUserResizeColumns" Value="True"/>
            <Setter Property="CanUserResizeRows" Value="True"/>
            <Setter Property="CanUserSortColumns" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="SelectionUnit" Value="Cell"/>
        </Style>

        <!-- Style voor DataGrid Headers -->
        <Style x:Key="ExcelHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>

        <!-- Style voor DataGrid Rows -->
        <Style x:Key="ExcelRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="MinHeight" Value="25"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#E6F3FF"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F0F8FF"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style voor DataGrid Cells -->
        <Style x:Key="ExcelCellStyle" TargetType="DataGridCell">
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#4A90E2"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="BorderBrush" Value="#2E5F8A"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Context Menu voor DataGrid -->
        <ContextMenu x:Key="DataGridContextMenu">
            <MenuItem Header="Kopiëren" Command="{Binding CopyCellCommand}"/>
            <MenuItem Header="Plakken" Command="{Binding PasteCellCommand}"/>
            <Separator/>
            <MenuItem Header="Rij invoegen" Command="{Binding InsertRowCommand}"/>
            <MenuItem Header="Rij verwijderen" Command="{Binding DeleteRowCommand}"/>
            <Separator/>
            <MenuItem Header="Kolom invoegen" Command="{Binding InsertColumnCommand}"/>
            <MenuItem Header="Kolom verwijderen" Command="{Binding DeleteColumnCommand}"/>
            <Separator/>
            <MenuItem Header="Cel opmaken..." Command="{Binding FormatCellCommand}"/>
        </ContextMenu>
    </Window.Resources>

    <!-- Main Layout met verschillende containers -->
    <DockPanel LastChildFill="True">

        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top" Background="#F8F8F8" BorderBrush="#CCCCCC" BorderThickness="0,0,0,1">
            <MenuItem Header="_Bestand">
                <MenuItem Header="_Nieuw werkboek" Command="{Binding NewWorkbookCommand}" InputGestureText="Ctrl+N"/>
                <MenuItem Header="_Openen..." Command="{Binding OpenWorkbookCommand}" InputGestureText="Ctrl+O"/>
                <MenuItem Header="_Opslaan" Command="{Binding SaveWorkbookCommand}" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Opslaan _als..." Command="{Binding SaveAsWorkbookCommand}"/>
                <Separator/>
                <MenuItem Header="_Afsluiten" Command="{Binding ExitCommand}" InputGestureText="Alt+F4"/>
            </MenuItem>
            <MenuItem Header="_Bewerken">
                <MenuItem Header="_Ongedaan maken" Command="{Binding UndoCommand}" InputGestureText="Ctrl+Z"/>
                <MenuItem Header="_Opnieuw" Command="{Binding RedoCommand}" InputGestureText="Ctrl+Y"/>
                <Separator/>
                <MenuItem Header="_Kopiëren" Command="{Binding CopyCommand}" InputGestureText="Ctrl+C"/>
                <MenuItem Header="_Plakken" Command="{Binding PasteCommand}" InputGestureText="Ctrl+V"/>
            </MenuItem>
            <MenuItem Header="_Weergave">
                <MenuItem Header="_Zoom in" Command="{Binding ZoomInCommand}" InputGestureText="Ctrl++"/>
                <MenuItem Header="Zoom _uit" Command="{Binding ZoomOutCommand}" InputGestureText="Ctrl+-"/>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <ToolBar DockPanel.Dock="Top" Background="#F0F0F0" BorderBrush="#CCCCCC" BorderThickness="0,0,0,1">
            <Button Command="{Binding NewWorkbookCommand}" ToolTip="Nieuw werkboek" Content="Nieuw"/>
            <Button Command="{Binding OpenWorkbookCommand}" ToolTip="Openen" Content="Openen"/>
            <Button Command="{Binding SaveWorkbookCommand}" ToolTip="Opslaan" Content="Opslaan"/>
            <Separator/>
            <Button Command="{Binding CopyCommand}" ToolTip="Kopiëren" Content="Kopiëren"/>
            <Button Command="{Binding PasteCommand}" ToolTip="Plakken" Content="Plakken"/>
        </ToolBar>

        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom" Background="#F8F8F8" BorderBrush="#CCCCCC" BorderThickness="0,1,0,0">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage, FallbackValue='Gereed'}"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Geselecteerde cel: "/>
                    <TextBlock Text="{Binding SelectedCellAddress, FallbackValue='A1'}" FontWeight="Bold"/>
                </StackPanel>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Zoom: "/>
                    <TextBlock Text="{Binding ZoomLevel, FallbackValue='100%'}"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>

        <!-- Main Content Area -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Zoek/Filter Panel -->
            <Border Grid.Row="0" Background="#F5F5F5" BorderBrush="#CCCCCC" BorderThickness="0,0,0,1" Padding="10,5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Zoeken:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Name="SearchTextBox" Width="200" Height="25" 
                             Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             ToolTip="Zoek in cellen..."/>
                    <Button Content="Zoek" Command="{Binding SearchCommand}" Margin="5,0,0,0" Padding="10,2"/>
                    <Button Content="Wissen" Command="{Binding ClearSearchCommand}" Margin="5,0,0,0" Padding="10,2"/>

                    <Separator Margin="20,0,20,0"/>

                    <TextBlock Text="Werkboek:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <ComboBox Name="WorkbookComboBox" Width="150" Height="25"
                              ItemsSource="{Binding Workbooks}"
                              SelectedItem="{Binding SelectedWorkbook}"
                              DisplayMemberPath="Name"
                              ToolTip="Selecteer werkboek"/>
                </StackPanel>
            </Border>

            <!-- Formula Bar -->
            <Border Grid.Row="1" Background="White" BorderBrush="#CCCCCC" BorderThickness="0,0,0,1" Padding="5">
                <DockPanel>
                    <TextBlock DockPanel.Dock="Left" Text="fx" FontWeight="Bold" 
                               VerticalAlignment="Center" Margin="5,0,10,0" 
                               Background="#E0E0E0" Padding="5,2"/>
                    <TextBox Name="FormulaTextBox" 
                             Text="{Binding SelectedCellFormula, UpdateSourceTrigger=PropertyChanged}"
                             FontFamily="Consolas" FontSize="12"
                             VerticalAlignment="Center" Height="25"
                             ToolTip="Formule of waarde invoeren"/>
                </DockPanel>
            </Border>

            <!-- Worksheet Tabs en DataGrid -->
            <TabControl Grid.Row="2" 
                        ItemsSource="{Binding CurrentWorkbook.Worksheets}"
                        SelectedItem="{Binding CurrentWorksheet}"
                        Background="White">

                <TabControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                            <Button Content="×" Command="{Binding CloseWorksheetCommand}" 
                                    Margin="5,0,0,0" Padding="2" FontSize="10"
                                    ToolTip="Werkblad sluiten"/>
                        </StackPanel>
                    </DataTemplate>
                </TabControl.ItemTemplate>

                <TabControl.ContentTemplate>
                    <DataTemplate>
                        <!-- ScrollViewer container voor grote datasets -->
                        <ScrollViewer HorizontalScrollBarVisibility="Auto" 
                                      VerticalScrollBarVisibility="Auto">

                            <!-- Main DataGrid -->
                            <DataGrid Name="SpreadsheetGrid"
                                      ItemsSource="{Binding Cells}"
                                      Style="{StaticResource ExcelDataGridStyle}"
                                      ColumnHeaderStyle="{StaticResource ExcelHeaderStyle}"
                                      RowStyle="{StaticResource ExcelRowStyle}"
                                      CellStyle="{StaticResource ExcelCellStyle}"
                                      AutoGenerateColumns="False"
                                      CanUserReorderColumns="False"
                                      IsReadOnly="False"
                                      SelectedItem="{Binding SelectedCell}"
                                      SelectionChanged="DataGrid_SelectionChanged"
                                      BeginningEdit="DataGrid_BeginningEdit"
                                      CellEditEnding="DataGrid_CellEditEnding"
                                      PreviewKeyDown="DataGrid_PreviewKeyDown">

                                <!-- Column Definitions (A-Z) -->
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="A" Width="80" 
                                                        Binding="{Binding ColumnA, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="B" Width="80" 
                                                        Binding="{Binding ColumnB, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="C" Width="80" 
                                                        Binding="{Binding ColumnC, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="D" Width="80" 
                                                        Binding="{Binding ColumnD, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="E" Width="80" 
                                                        Binding="{Binding ColumnE, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="F" Width="80" 
                                                        Binding="{Binding ColumnF, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="G" Width="80" 
                                                        Binding="{Binding ColumnG, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="H" Width="80" 
                                                        Binding="{Binding ColumnH, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="I" Width="80" 
                                                        Binding="{Binding ColumnI, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="J" Width="80" 
                                                        Binding="{Binding ColumnJ, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="K" Width="80" 
                                                        Binding="{Binding ColumnK, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="L" Width="80" 
                                                        Binding="{Binding ColumnL, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="M" Width="80" 
                                                        Binding="{Binding ColumnM, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="N" Width="80" 
                                                        Binding="{Binding ColumnN, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTextColumn Header="O" Width="80" 
                                                        Binding="{Binding ColumnO, UpdateSourceTrigger=PropertyChanged}"/>
                                </DataGrid.Columns>

                                <!-- Row Header Template -->
                                <DataGrid.RowHeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding RowNumber}" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   VerticalAlignment="Center"
                                                   Background="#F5F5F5" 
                                                   Padding="5,2"/>
                                    </DataTemplate>
                                </DataGrid.RowHeaderTemplate>

                                <!-- Context Menu op DataGrid niveau -->
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Kopiëren" Command="{Binding CopyCellCommand}"/>
                                        <MenuItem Header="Plakken" Command="{Binding PasteCellCommand}"/>
                                        <Separator/>
                                        <MenuItem Header="Rij invoegen" Command="{Binding InsertRowCommand}"/>
                                        <MenuItem Header="Rij verwijderen" Command="{Binding DeleteRowCommand}"/>
                                        <Separator/>
                                        <MenuItem Header="Kolom invoegen" Command="{Binding InsertColumnCommand}"/>
                                        <MenuItem Header="Kolom verwijderen" Command="{Binding DeleteColumnCommand}"/>
                                    </ContextMenu>
                                </DataGrid.ContextMenu>

                            </DataGrid>
                        </ScrollViewer>
                    </DataTemplate>
                </TabControl.ContentTemplate>
            </TabControl>
        </Grid>
    </DockPanel>

    <!-- Input Bindings voor Keyboard Shortcuts -->
    <Window.InputBindings>
        <KeyBinding Key="N" Modifiers="Ctrl" Command="{Binding NewWorkbookCommand}"/>
        <KeyBinding Key="O" Modifiers="Ctrl" Command="{Binding OpenWorkbookCommand}"/>
        <KeyBinding Key="S" Modifiers="Ctrl" Command="{Binding SaveWorkbookCommand}"/>
        <KeyBinding Key="C" Modifiers="Ctrl" Command="{Binding CopyCommand}"/>
        <KeyBinding Key="V" Modifiers="Ctrl" Command="{Binding PasteCommand}"/>
        <KeyBinding Key="Z" Modifiers="Ctrl" Command="{Binding UndoCommand}"/>
        <KeyBinding Key="Y" Modifiers="Ctrl" Command="{Binding RedoCommand}"/>
        <KeyBinding Key="F" Modifiers="Ctrl" Command="{Binding FindCommand}"/>
    </Window.InputBindings>

</Window>